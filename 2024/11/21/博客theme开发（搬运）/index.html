<!DOCTYPE html>
<html lang="en">
    
    <head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" name="viewport" />
    <meta name="description" content="博客theme开发（搬运）" />
    <meta name="hexo-theme-A4" content="v1.9.6" />
    <link rel="alternate icon" type="image/webp" href="/vate.jpg">
    <title>Hello world | :)</title>

    
        
<link rel="stylesheet" href="/css/highlight/style1.css">

        
<link rel="stylesheet" href="/css/reset.css">

        
<link rel="stylesheet" href="/css/markdown.css">

        
<link rel="stylesheet" href="/css/fonts.css">
 
         <!--注意：首页既不是post也不是page-->
        
        
        
<link rel="stylesheet" href="/css/ui.css">
 
        
<link rel="stylesheet" href="/css/style.css">


        
            <!--返回顶部css-->
            
<link rel="stylesheet" href="/css/returnToTop.css">

            
<link rel="stylesheet" href="/css/unicons.css">

        
        
            <!--目录-->
            
<link rel="stylesheet" href="/css/toc.css">

        
    

    
        
<link rel="stylesheet" href="/css/returnToLastPage.css">

    
    
   
<link rel="stylesheet" href="/css/lightgallery-bundle.min.css">


<meta name="generator" content="Hexo 7.3.0"></head>
    
    
        <style>
            .index-main{
                max-width:  880px;
            }
        </style>

    
    



    

    
    

    
    <style>
        :root {
            --waline-theme-color: #fec591; 
            --waline-color: #fec591; 
            --waline-border-color: #fec591; 
            --waline-white: #fec591; 
            --waline-bgcolor-light: #005454;  
        }
        body {
            color: #fec591;
            background: #005454;
        }
        .post-md code {
            background: black;
            color: white; 
        }
        .post-md pre, .post-md .highlight {
            background: black;
            color: white; 
        }
        pre .string, pre .value, pre .inheritance, pre .header, pre .ruby .symbol, pre .xml .cdata {
            color: #fec591;
        }
        pre .number, pre .preprocessor, pre .built_in, pre .literal, pre .params, pre .constant {
            color: #fec591;
        }
        .year-font-color {
            color: #fec591 !important;
        }
        .wl-card span.wl-nick {
            color: #fec591; 
        }
        .wl-card .wl-badge {
            border: 1px solid #fec591;
            color: #fec591; 
        }
        .wl-btn {
            border: 1px solid #fec591; 
            color:  #fec591;  
        }
        .wl-btn.primary {
            color: #005454; 
        }
        .wl-header label {
            color: #fec591;
        }
        a {
            color: #fec591;
        }

        .post-md a {
            color: #fec591;
        }

        .nav li a {
            color: #fec591;
        }

        .archive-main a:link {
            color: #fec591;
        }
        .archive-main a:visited {
            color: #fec591; 
        }

        .archive li span {
            color: #fec591;
        }

        .post-main-title {
            color: #fec591;
        }

        .post-md h1,
        .post-md h2,
        .post-md h3,
        .post-md h4,
        .post-md h5,
        .post-md h6 {
            color: #fec591;
        }

        [data-waline] p {
            color: #fec591;
        }
        [data-waline] a {
            color: #fec591;
        } 
        .wl-sort li.active {
            color: #fec591;
        }

        .wl-card .wl-meta>span {
            background: #005454;
        }

        .paper {
            background: #005454;
        }

        .index-main {
            background: #005454;
        }

        .paper-main {
            background: #005454;
        }

        .wl-panel {
            background: #005454;
        }

        .archive li:nth-child(odd) {
            background: #005454;
            ;
        }

        .archive li:nth-child(even) {
            background: #005454;
        }

        .post-md table tr:nth-child(odd) td {
            background: #005454;
        }

        .post-md table tr:nth-child(even) td {
            background: #005454;
        }

    
        .progress-wrap::after {
            color: #fec591; /* 箭头的颜色 */
        }
        .progress-wrap svg.progress-circle path {
	        stroke: #fec591; /* 边框的颜色 */
        }
        .progress-wrap::before {
	        background-image: linear-gradient(298deg, #fec591, #fec591); /* 鼠标滑过的箭头颜色 */
         }

        .return-to-last-progress-wrap::after {
            color: #fec591; /* 箭头的颜色 */
        }
        .return-to-last-progress-wrap svg.progress-circle path {
	        stroke: #fec591; /* 边框的颜色 */
        }
        .return-to-last-progress-wrap::before {
	        background-image: linear-gradient(298deg, #fec591, #fec591); /* 鼠标滑过的箭头颜色 */
         }

         .left-toc-container::-webkit-scrollbar-thumb {
            background-color: #fec591; /* 设置滚动条拖动块的颜色 */
        }

        .bs-docs-sidebar .nav>.active>a,
        .bs-docs-sidebar .nav>li>a:hover,
        .bs-docs-sidebar .nav>li>a:focus {
            color: #fec591;
            border-left-color: #fec591;
        }
        .bs-docs-sidebar .nav>li>a {
            color:  #fec591;
        }
    </style>

    
    
    <body>
        <script src="/js/darkmode-js.min.js"></script>
        
        <script>
            const options = {
                bottom: '40px', // default: '32px'
                right: 'unset', // default: '32px'
                left: '42px', // default: 'unset'
                time: '0.3s', // default: '0.3s'
                mixColor: '#fff', // default: '#fff'
                backgroundColor: ' #005454  ',  // default: '#fff'
                buttonColorDark: '#100f2c',  // default: '#100f2c'
                buttonColorLight: '#fff', // default: '#fff'
                saveInCookies: true, // default: true,
                label: '🌓', // default: ''
                autoMatchOsTheme: true // default: true
            }
            const darkmode = new Darkmode(options);
            darkmode.showWidget();
        </script>
        
        
            <div class="left-toc-container">
                <nav id="toc" class="bs-docs-sidebar"></nav>
            </div>
        
        <div class="paper">
            
            
            
            
                <div class="shadow-drop-2-bottom paper-main">
                    


<div class="header">
    <div class="header-container">
        <img style="
        width: 56px;
        height: auto;" alt="^-^" cache-control="max-age=86400" class="header-img" src="/vate.jpg" width="10%"></img>
        <div class="header-content">
            <a class="logo" href="/">Hello world</a> 
            <span class="description">Life love </span> 
        </div>
        
    </div>
    
   
    <ul class="nav">
        
            
                <li><a href="/">🏠首页</a></li>
            
        
            
                <li><a href="/list/">📜文章</a></li>
            
        
            
                <li><a href="/categories/">📁分类</a></li>
            
        
            
                <li><a href="/about/">❓关于</a></li>
            
        
    </ul>
</div> 
        
                    
                    

                    
                    
                    
                    <!--说明是文章post页面-->
                    
                        <div class="post-main">
    

    
        
            
                <div class="post-main-title" style="text-align: center;">
                    博客theme开发（搬运）
                </div>
            
        
      
    

    

        
            <div class="post-head-meta-center">
        
                
                    <span>最近更新：2024-11-21</span> 
                
                
                    
                        &nbsp; | &nbsp;
                    
                     <span>字数总计：9k</span>
                
                
                    
                        &nbsp; | &nbsp;
                    
                    <span>阅读估时：44分钟</span>
                
                
                    
                        &nbsp; | &nbsp;
                    
                    <span id="busuanzi_container_page_pv">
                        阅读量：<span id="busuanzi_value_page_pv"></span>次
                    </span>
                
            </div>
    

    <div class="post-md">
        
            
                <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E4%B8%BB%E9%A2%98%E5%BC%80%E5%8F%91"><span class="post-toc-text">主题开发</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84"><span class="post-toc-text">目录结构</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E6%A8%A1%E5%9D%97%E4%BB%8B%E7%BB%8D"><span class="post-toc-text">模块介绍</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#EJS-%E6%A0%87%E7%AD%BE"><span class="post-toc-text">EJS 标签</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Hexo-%E5%8F%98%E9%87%8F"><span class="post-toc-text">Hexo 变量</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E4%B8%BB%E9%A2%98%E5%88%B6%E4%BD%9C"><span class="post-toc-text">主题制作</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E4%B8%BB%E9%A2%98%E5%B8%83%E5%B1%80"><span class="post-toc-text">主题布局</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84"><span class="post-toc-text">文件结构</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E4%B8%BB%E9%A2%98%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="post-toc-text">主题配置文件</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E8%AE%BE%E8%AE%A1%E4%B8%BB%E5%B8%83%E5%B1%80%E6%96%87%E4%BB%B6"><span class="post-toc-text">设计主布局文件</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E6%B7%BB%E5%8A%A0%E5%AF%BC%E8%88%AA%E6%A0%8F"><span class="post-toc-text">添加导航栏</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E6%B7%BB%E5%8A%A0%E4%BE%A7%E8%BE%B9%E6%A0%8F"><span class="post-toc-text">添加侧边栏</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E6%B7%BB%E5%8A%A0%E6%96%87%E7%AB%A0"><span class="post-toc-text">添加文章</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%9B%BE%E7%89%87%E6%8F%92%E4%BB%B6"><span class="post-toc-text">图片插件</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E4%BB%A3%E7%A0%81%E9%AB%98%E4%BA%AE"><span class="post-toc-text">代码高亮</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E7%9B%AE%E5%BD%95%E7%82%B9%E5%87%BB%E4%BA%8B%E4%BB%B6"><span class="post-toc-text">目录点击事件</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E6%90%9C%E7%B4%A2"><span class="post-toc-text">搜索</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%B1%80%E9%83%A8%E5%88%B7%E6%96%B0"><span class="post-toc-text">局部刷新</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E6%96%87%E7%AB%A0%E7%B4%A2%E5%BC%95%E7%9B%AE%E5%BD%95"><span class="post-toc-text">文章索引目录</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E4%B8%BB%E9%A1%B5"><span class="post-toc-text">主页</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%85%B3%E4%BA%8E"><span class="post-toc-text">关于</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%8A%A8%E6%BC%AB%E5%A6%B9%E7%BA%B8%E6%8C%82%E4%BB%B6"><span class="post-toc-text">动漫妹纸挂件</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E6%89%8B%E6%9C%BA%E7%AB%AF%E8%87%AA%E9%80%82%E5%BA%94"><span class="post-toc-text">手机端自适应</span></a></li></ol></li></ol>
            
        
        <div class=".article-gallery"><p>原作者：博客园@猴子请来的救兵</p>
<p>原文地址：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/yyhh/p/11058985.html">Hexo主题开发 - ﹏猴子请来的救兵 - 博客园</a></p>
<p>声明：仅用于本人留档收藏，删改了一部分内容。</p>
<blockquote>
<p>本文由 <a target="_blank" rel="noopener" href="http://ksria.com/simpread/">简悦 SimpRead</a> 转码， 原文地址 <a target="_blank" rel="noopener" href="https://www.cnblogs.com/yyhh/p/11058985.html">www.cnblogs.com</a></p>
</blockquote>
<h2 id="主题开发"><a href="#主题开发" class="headerlink" title="主题开发"></a>主题开发</h2><h3 id="目录结构"><a href="#目录结构" class="headerlink" title="目录结构"></a>目录结构</h3><p>首先得创建一个自己 Blog 的文件夹，我这边建的文件夹叫『 wiki 』，然后在这个文件夹下，进行 Hexo 的初始化。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir wiki</span><br><span class="line">cd wiki</span><br><span class="line">hexo init</span><br></pre></td></tr></table></figure>

<p>初始化之后就会有一个这样的目录。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">wiki ➔  tree -L 1</span><br><span class="line">.</span><br><span class="line">├── _config.yml       // 总体的配置文件</span><br><span class="line">├── node_modules      // NodeJs 所依赖的包，后期也可以自己添加插件</span><br><span class="line">├── package-lock.json // 支持 hexo 运行的 NodeJs 包</span><br><span class="line">├── package.json      // 自定义的 NodeJs 包</span><br><span class="line">├── scaffolds         // Hexo Markdown 加载时的关键字，如data,title等,它会在启动的时候默认加载</span><br><span class="line">├── source            // md 源文件目录</span><br><span class="line">└── themes            // 主题文件夹</span><br><span class="line">    └── landscape     // 默认主题        </span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>我们编写 md 文档放在 『source』文件夹中，在运行『hexo generate』的时候，会根据『source』目录中的 md 文件自动生成一组 『html』格式的静态文件组，会在 wiki 目录下新建一个 『public』目录，存放在其中。</p>
<p>在『_config.yml』中的 73 行左右，可以看到配置的默认主题『theme: landscape』, 所对应的是 themes 目录下的 landscape 目录。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># Extensions</span><br><span class="line">## Plugins: https://hexo.io/plugins/</span><br><span class="line">## Themes: https://hexo.io/themes/</span><br><span class="line">theme: landscape</span><br></pre></td></tr></table></figure>

<p>在『themes』目录下，新建一个自己的主题『wiki』，并且新建一些可以支持运行的文件与目录，按照如下目录格式创建，里面可以不写东西，下面写有注释的，就是我新建的文件。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">wiki ➔  tree -L 1</span><br><span class="line">.</span><br><span class="line">├── _config.yml                 </span><br><span class="line">├── node_modules                </span><br><span class="line">├── package-lock.json        </span><br><span class="line">├── package.json                </span><br><span class="line">├── scaffolds                        </span><br><span class="line">├── source                            </span><br><span class="line">└── themes                            </span><br><span class="line">    ├── landscape</span><br><span class="line">    └── wiki                // 自建的主题目录</span><br><span class="line">        ├── _config.yml     // 主题配置文件</span><br><span class="line">        ├── layout          // 主要构造 html 的模板</span><br><span class="line">        │   ├── index.ejs   // 主页模板</span><br><span class="line">        │   ├── layout.ejs  // 布局模板</span><br><span class="line">        │   └── post.ejs    // md 编译成 html 后的文件模板</span><br><span class="line">        └── source          // 静态资源文件目录</span><br><span class="line">            ├── css         // css 样式目录</span><br><span class="line">            └── js          // JavaScript 脚本目录</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>在『_config.yml』中 73 行左右修改主题，指向刚创建的 wiki 目录。</p>
<p>这里的『_config.yml』指的是 Hexo 的配置文件。</p>
<p>后面如果要修改主题的配置文件，全部都会叫做 『themes._config.yml』。</p>
<p>想要了解更加详细的资料可以去查阅<a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/docs/configuration">官网配置详解</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># Extensions</span><br><span class="line">## Plugins: https://hexo.io/plugins/</span><br><span class="line">## Themes: https://hexo.io/themes/</span><br><span class="line">## theme: landscape</span><br><span class="line">theme: wiki</span><br></pre></td></tr></table></figure>

<p>在 wiki 目录下，启动 hexo 进行测试</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 可以使用 hexo server 也可以直接简写 hexo s</span><br><span class="line">hexo s</span><br><span class="line">INFO  Start processing</span><br><span class="line">INFO  Hexo is running at http://localhost:4000 . Press Ctrl+C to stop.</span><br></pre></td></tr></table></figure>

<p>访问 <a target="_blank" rel="noopener" href="http://localhost:4000/">http://localhost:4000/</a></p>
<p>可以看到一个白色的界面</p>
<p><a href="/img/626593-20190620151955999-1464232325.png" class="gallery-item" style="box-shadow: none;"> <img src="/img/626593-20190620151955999-1464232325.png"></a></p>
<h3 id="模块介绍"><a href="#模块介绍" class="headerlink" title="模块介绍"></a>模块介绍</h3><p>为了测试该界面，分别在刚刚新建的 layout.ejs、index.ejs、post.ejs 中加些文字。</p>
<p>『layout.ejs』 这个文件是用于布局的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">这里是 layout.ejs</span><br></pre></td></tr></table></figure>

<p>『index.ejs』 这个文件是用于主页的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">这里是 index.ejs</span><br></pre></td></tr></table></figure>

<p>『post.ejs』 这个文件是用于文章的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">这里是 post.ejs</span><br></pre></td></tr></table></figure>

<p>刷新 <a target="_blank" rel="noopener" href="http://localhost:4000/">http://localhost:4000/</a>，可以看到有中文乱码。</p>
<p><a href="/img/626593-20190620152000477-411265650.png" class="gallery-item" style="box-shadow: none;"> <img src="/img/626593-20190620152000477-411265650.png"></a></p>
<p>在 『layout.ejs』加上 html 代码，加上 utf-8 编码显示。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;&lt;/title&gt;</span><br><span class="line">    &lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">    这里是 layout.ejs</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>重启 hexo 服务 【注意: 这次要重启，还是乱码的请重启】</p>
<p>重启好了再刷新 <a target="_blank" rel="noopener" href="http://localhost:4000/">http://localhost:4000/</a></p>
<p><a href="/img/626593-20190620152004943-1360260387.png" class="gallery-item" style="box-shadow: none;"> <img src="/img/626593-20190620152004943-1360260387.png"></a></p>
<p>可以发现 layout.ejs 给默认展示出来了，但是 index.ejs 和 post.ejs 呢？</p>
<p>可以用 ejs 引入代码，将这两个模板给引入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;&lt;/title&gt;</span><br><span class="line">    &lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">    这里是 layout.ejs</span><br><span class="line"></span><br><span class="line">    &lt;%- include(&quot;index.ejs&quot;) %&gt;</span><br><span class="line"></span><br><span class="line">    &lt;%- include(&quot;post.ejs&quot;) %&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p><a href="/img/626593-20190620152009394-1616654742.png" class="gallery-item" style="box-shadow: none;"> <img src="/img/626593-20190620152009394-1616654742.png"></a></p>
<h3 id="EJS-标签"><a href="#EJS-标签" class="headerlink" title="EJS 标签"></a>EJS 标签</h3><p>这里简单介绍一下 ejs 语法，介绍几个用的到的标签也是就好了。想要了解更加详细的资料可以查阅 <a target="_blank" rel="noopener" href="https://ejs.bootcss.com/">EJS 文档</a>。</p>
<table><thead><tr><th>标签</th><th>含义</th></tr></thead><tbody><tr><td>&lt;%</td><td>脚本标签，用于流程控制</td></tr><tr><td>&lt;%_</td><td>删除前面的空格符</td></tr><tr><td>&lt;%=</td><td>输出数据到模板</td></tr><tr><td>&lt;%-</td><td>输出非转义数据到模板</td></tr><tr><td>&lt;%#</td><td>注释</td></tr><tr><td>&lt;%%</td><td>输出字符串『&lt;%』</td></tr><tr><td>&gt;%</td><td>脚本结束标签</td></tr><tr><td>-%&gt;</td><td>结束时，删除换行符</td></tr><tr><td>_%&gt;</td><td>结束时，删除空格符</td></tr><tr><td>&lt;%- include("index.ejs") %&gt;</td><td>引入其他模板</td></tr></tbody></table>

<p>上面代码就引入了各个 ejs 模板，可以更加方便用于模块开发。稍微测试一下</p>
<p>『layout.ejs』</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;&lt;/title&gt;</span><br><span class="line">    &lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">    这里是 layout.ejs</span><br><span class="line"></span><br><span class="line">    &lt;%- include(&quot;index.ejs&quot;) %&gt;</span><br><span class="line"></span><br><span class="line">    &lt;%- include(&quot;post.ejs&quot;) %&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 一般在写逻辑的时候会用到这个标签，这个标签不会输出到页面上 --&gt;</span><br><span class="line">    &lt;%  %&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 这个标签会输出到页面上，是带着非转义符号的 --&gt;</span><br><span class="line">    &lt;% </span><br><span class="line">        var test = &quot;基本上，就用这两组标签，其他的也用不上。&quot;;</span><br><span class="line">    %&gt;</span><br><span class="line"></span><br><span class="line">    &lt;%- test %&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p><a href="/img/626593-20190620152016362-1034019730.png" class="gallery-item" style="box-shadow: none;"> <img src="/img/626593-20190620152016362-1034019730.png"></a></p>
<h3 id="Hexo-变量"><a href="#Hexo-变量" class="headerlink" title="Hexo 变量"></a>Hexo 变量</h3><p>再一个就是要介绍一下，<a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/docs/variables">Hexo Api</a> 我们会根据它提供的变量 api 来获取页面信息，进行 Blog 开发。同样介绍一下稍微常用的。</p>
<table><thead><tr><th>变量</th><th>描述</th></tr></thead><tbody><tr><td>site</td><td>总体变量，几乎都是从这里开始的</td></tr><tr><td>site.posts</td><td>所有文章</td></tr><tr><td>site.posts[0].path</td><td>文章路径，带日期的</td></tr><tr><td>site.posts[0].slug</td><td>文章路径，根据项目文件夹的路径来的</td></tr><tr><td>site.posts[0]._id</td><td>文章的唯一 id，后面会用于 active 对比</td></tr><tr><td>site.posts[0].title</td><td>文章的标题</td></tr><tr><td>site.posts[0].date</td><td>文章的时间</td></tr><tr><td>page.date</td><td>在直接访问文章路径下，文章的时间</td></tr><tr><td>page.title</td><td>在直接访问文章路径下，文章的标题</td></tr><tr><td>page._id</td><td>在直接访问文章路径下，文章的的唯一 id，后面会用于 active 对比</td></tr><tr><td>page.content</td><td>引入对应文章的正文</td></tr><tr><td>config.xxx</td><td>总体配置文件的引用 _config.yml</td></tr><tr><td>theme.xxx</td><td>主题配置文件 theme._config.yml</td></tr><tr><td>&lt;%- body %&gt;</td><td>同时引入 post.ejs 和 index.ejs</td></tr><tr><td>&lt;%- css(path, ...) %&gt;</td><td>引入 css 文件</td></tr><tr><td>&lt;%- js(path, ...) %&gt;</td><td>引入 js 文件</td></tr></tbody></table>

<p>同样是稍微的测试一下</p>
<p>『layout.ejs』</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;&lt;/title&gt;</span><br><span class="line">    &lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">    这里是 layout.ejs</span><br><span class="line"></span><br><span class="line">    &lt;%- include(&quot;index.ejs&quot;) %&gt;</span><br><span class="line"></span><br><span class="line">    &lt;%- include(&quot;post.ejs&quot;) %&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 一般在写逻辑的时候会用到这个标签，这个标签不会输出到页面上 --&gt;</span><br><span class="line">    &lt;%  %&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 这个标签会输出到页面上，是带着非转义符号的 --&gt;</span><br><span class="line">    &lt;% </span><br><span class="line">        var test = &quot;基本上，就用这两组标签，其他的也用不上。&quot;;</span><br><span class="line">    %&gt;</span><br><span class="line"></span><br><span class="line">    &lt;%- test %&gt;</span><br><span class="line"></span><br><span class="line">    &lt;br /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;% site.posts.forEach(function(post)&#123; %&gt;</span><br><span class="line"></span><br><span class="line">        &lt;%- post.path %&gt;</span><br><span class="line">        &lt;br /&gt;</span><br><span class="line">        &lt;%- post.slug %&gt;</span><br><span class="line">        &lt;br /&gt;</span><br><span class="line">        &lt;%- post._id %&gt;</span><br><span class="line">        &lt;br /&gt;</span><br><span class="line">        &lt;%- post.title %&gt;</span><br><span class="line">        &lt;br /&gt;</span><br><span class="line">        &lt;%- post.date %&gt;</span><br><span class="line">        &lt;br /&gt;</span><br><span class="line"></span><br><span class="line">        &lt;a href=&quot;/&lt;%- post.path %&gt;&quot;&gt;&lt;%- post.title %&gt;&lt;/a&gt;</span><br><span class="line"></span><br><span class="line">    &lt;% &#125;); %&gt;</span><br><span class="line">  </span><br><span class="line">![](https://img2018.cnblogs.com/blog/626593/201906/626593-20190620152507609-296007299.png)</span><br><span class="line"></span><br><span class="line">  &lt;%- body %&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p><a href="/img/626593-20190620152026766-274939183.png" class="gallery-item" style="box-shadow: none;"> <img src="/img/626593-20190620152026766-274939183.png"></a></p>
<p>可以看到，点击了这个 Hello World 的超链接，跳转过去，并没有看到任何信息，是因为在 post.ejs 中没有引入文章，所以没有信息，这个时候在 post.ejs 中引入文章</p>
<p>『post.ejs』</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">这里是 post.ejs</span><br><span class="line"></span><br><span class="line">&lt;%- page.content %&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><a href="/img/626593-20190620152030509-1216095051.png" class="gallery-item" style="box-shadow: none;"> <img src="/img/626593-20190620152030509-1216095051.png"></a></p>
<p>这个时候访问主页的 Hello World 之后，就会访问文章的 url 了，此时也有文章出现了。</p>
<p>如果想要看变量里面都是什么东西，可以使用 js 的 console.log() 来查看，在控制台中查看</p>
<p>『layout.ejs』</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;&lt;/title&gt;</span><br><span class="line">    &lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">    &lt;% console.log(site.posts) %&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<h2 id="主题制作"><a href="#主题制作" class="headerlink" title="主题制作"></a>主题制作</h2><h3 id="主题布局"><a href="#主题布局" class="headerlink" title="主题布局"></a>主题布局</h3><p>说道这里，万事俱备，就可以正儿八经的开始做事了。我想要一个这样布局的 wiki</p>
<p><a href="/img/626593-20190620152038579-1659913265.png" class="gallery-item" style="box-shadow: none;"> <img src="/img/626593-20190620152038579-1659913265.png"></a></p>
<h3 id="文件结构"><a href="#文件结构" class="headerlink" title="文件结构"></a>文件结构</h3><p>新建静态资源文件，并且放一下测试的 md 文件进 _posts 中，整个 wiki 的目录如下。主要添加了 theme.wiki.source 中的静态资源和已经布局用的 ejs</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">wiki ➔  tree -N</span><br><span class="line">.</span><br><span class="line">├── _config.yml</span><br><span class="line">├── db.json</span><br><span class="line">├── node_modules</span><br><span class="line">├── package-lock.json</span><br><span class="line">├── package.json</span><br><span class="line">├── scaffolds</span><br><span class="line">├── source</span><br><span class="line">│   └── _posts</span><br><span class="line">│       ├── Docker</span><br><span class="line">│       │   ├── 基础介绍</span><br><span class="line">│       │   │   ├── 01. 镜像.md</span><br><span class="line">│       │   │   ├── 02. 容器.md</span><br><span class="line">│       │   │   ├── 03. 数据.md</span><br><span class="line">│       │   │   ├── 04. 仓库.md</span><br><span class="line">│       │   │   ├── 05. 网络.md</span><br><span class="line">│       │   │   └── 06. Dockerfile.md</span><br><span class="line">│       │   └── 镜像部署</span><br><span class="line">│       │       ├── CentOS</span><br><span class="line">│       │       │   └── success.png</span><br><span class="line">│       │       ├── CentOS.md</span><br><span class="line">│       │       ├── Git.md</span><br><span class="line">│       │       ├── MongoDB.md</span><br><span class="line">│       │       ├── MySQL.md</span><br><span class="line">│       │       ├── Redis.md</span><br><span class="line">│       │       └── Tomcat.md</span><br><span class="line">│       ├── Hexo</span><br><span class="line">│       │   ├── 安装</span><br><span class="line">│       │   │   ├── img-20180627184245526.png</span><br><span class="line">│       │   │   ├── img-20180627190554905.png</span><br><span class="line">│       │   │   └── img-20180627190808193.png</span><br><span class="line">│       │   ├── 安装.md</span><br><span class="line">│       │   ├── 主题开发</span><br><span class="line">│       │   │   ├── img-20180627190808193.png</span><br><span class="line">│       │   │   ├── img-20190611175811781.png</span><br><span class="line">│       │   │   ├── img-20190611180317902.png</span><br><span class="line">│       │   │   ├── img-20190611180729426.png</span><br><span class="line">│       │   │   ├── img-20190611181023821.png</span><br><span class="line">│       │   │   ├── img-20190611210222968.png</span><br><span class="line">│       │   │   ├── img-20190611212914872.png</span><br><span class="line">│       │   │   ├── img-20190611213529727.png</span><br><span class="line">│       │   │   ├── img-20190611214947308.png</span><br><span class="line">│       │   │   └── 布局.png</span><br><span class="line">│       │   └── 主题开发.md</span><br><span class="line">│       └── test-hello-world.md</span><br><span class="line">└── themes</span><br><span class="line">    ├── landscape</span><br><span class="line">    └── wiki</span><br><span class="line">        ├── _config.yml</span><br><span class="line">        ├── layout</span><br><span class="line">        │   ├── aside.ejs   // 用于侧边栏</span><br><span class="line">        │   ├── index.ejs   // 用于主页</span><br><span class="line">        │   ├── layout.ejs  // 用于布局</span><br><span class="line">        │   ├── nav.ejs     // 用于导航</span><br><span class="line">        │   └── post.ejs    // 用于文章</span><br><span class="line">        └── source</span><br><span class="line">            ├── css</span><br><span class="line">            │   └── main.css</span><br><span class="line">            ├── js</span><br><span class="line">            │   └── main.js</span><br><span class="line">            └── lib</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="主题配置文件"><a href="#主题配置文件" class="headerlink" title="主题配置文件"></a>主题配置文件</h3><p>在 theme._config.yml 配置文件中，添加自己主题的标题，用于 layout.ejs 的引用。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">title: IT Abyss Wiki</span><br><span class="line"></span><br><span class="line">author: 猴子请来的救兵</span><br><span class="line"></span><br><span class="line">menus: </span><br><span class="line">  主页: /</span><br><span class="line">  关于: /about</span><br><span class="line"></span><br><span class="line">links:</span><br><span class="line">  博客园: https://www.cnblogs.com/yyhh/</span><br><span class="line">  github: https://github.com</span><br></pre></td></tr></table></figure>

<h3 id="设计主布局文件"><a href="#设计主布局文件" class="headerlink" title="设计主布局文件"></a>设计主布局文件</h3><p>『layout.ejs』</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;&lt;%- theme.title %&gt;&lt;/title&gt;</span><br><span class="line">    &lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 引入配置文件 --&gt;</span><br><span class="line">    &lt;%- css(&#x27;css/main.css&#x27;) %&gt;</span><br><span class="line">    </span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">    &lt;div id=&quot;main&quot;&gt;</span><br><span class="line">        &lt;!-- 引入侧边栏 --&gt;</span><br><span class="line">        &lt;aside id=&quot;#aside&quot;&gt;</span><br><span class="line">            &lt;%- include(&#x27;aside.ejs&#x27;) %&gt;</span><br><span class="line">        &lt;/aside&gt;</span><br><span class="line"></span><br><span class="line">        &lt;!-- 引入导航 --&gt;</span><br><span class="line">        &lt;nav&gt;</span><br><span class="line">            &lt;%- include(&#x27;nav.ejs&#x27;) %&gt;</span><br><span class="line">        &lt;/nav&gt;</span><br><span class="line"></span><br><span class="line">        &lt;!-- 引入正文 --&gt;</span><br><span class="line">        &lt;div id=&quot;content&quot;&gt;</span><br><span class="line">      &lt;%- body %&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        </span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 引入 js 文件 --&gt;</span><br><span class="line">    &lt;%- js(&#x27;js/main.js&#x27;) %&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>订制 css 样式表中的测试样式，添加几个测试的颜色，便于观察布局。</p>
<p>『css&#x2F;main.css』</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">/* #################### 全局 #################### */</span><br><span class="line">* &#123;</span><br><span class="line">    margin: 0;</span><br><span class="line">    padding: 0;</span><br><span class="line">    border: 0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">html, body &#123;</span><br><span class="line">    height: 100%;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">aside &#123;</span><br><span class="line">    width: 300px;</span><br><span class="line">    height: 100%;</span><br><span class="line">    position: fixed;</span><br><span class="line">    background: #262a30;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">nav &#123;</span><br><span class="line">    height: 50px;</span><br><span class="line">    background: #b9e1b1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#content &#123;</span><br><span class="line">    height: 100%;</span><br><span class="line">    padding-left: 300px;</span><br><span class="line">    background: #f9f7ed;</span><br><span class="line">&#125;</span><br><span class="line">/* #################### 全局 #################### */</span><br></pre></td></tr></table></figure>

<p><a href="/img/626593-20190620152053346-1194447699.png" class="gallery-item" style="box-shadow: none;"> <img src="/img/626593-20190620152053346-1194447699.png"></a></p>
<h3 id="添加导航栏"><a href="#添加导航栏" class="headerlink" title="添加导航栏"></a>添加导航栏</h3><p>将刚刚配置文件里面加的导航给列出来</p>
<p>『nav.ejs』</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;ul id=&quot;menu&quot;&gt;</span><br><span class="line">    &lt;!-- 内部链接本页面直接跳转 --&gt;</span><br><span class="line">    &lt;% for ( menu in theme.menus ) &#123; %&gt;</span><br><span class="line">    &lt;li class=&quot;menu-item&quot;&gt;</span><br><span class="line">        &lt;a href=&quot;&lt;%- theme.menus[menu] %&gt;&quot; class=&quot;menu-item-link&quot;&gt;&lt;%- menu %&gt;&lt;/a&gt;</span><br><span class="line">    &lt;/li&gt;</span><br><span class="line">    &lt;% &#125; %&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 外部链接打开新的窗口跳转 --&gt;</span><br><span class="line">    &lt;% for ( link in theme.links ) &#123; %&gt;</span><br><span class="line">    &lt;li class=&quot;menu-item&quot;&gt;</span><br><span class="line">        &lt;a href=&quot;&lt;%- theme.links[link] %&gt;&quot; class=&quot;menu-item-link&quot; target=&quot;_blank&quot;&gt;&lt;%- link %&gt;&lt;/a&gt;</span><br><span class="line">    &lt;/li&gt;</span><br><span class="line">    &lt;% &#125; %&gt;</span><br><span class="line"></span><br><span class="line">&lt;/ul&gt;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>添加 css 美化</p>
<p>『main.css』</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">/* #################### 导航 #################### */</span><br><span class="line">nav #menu &#123;</span><br><span class="line">    float: right;</span><br><span class="line">    padding-right: 20px;</span><br><span class="line">&#125;</span><br><span class="line">nav ul li &#123;</span><br><span class="line">    float: left;</span><br><span class="line">    padding: 10px;</span><br><span class="line">    list-style: none;</span><br><span class="line">&#125;</span><br><span class="line">nav ul li a&#123;</span><br><span class="line">    color: #555;</span><br><span class="line">    font-size: 12px;</span><br><span class="line">    text-decoration: none;</span><br><span class="line">&#125;</span><br><span class="line">nav ul li a:hover &#123;</span><br><span class="line">    border-bottom: 1px solid;</span><br><span class="line">&#125;</span><br><span class="line">/* #################### 导航 #################### */</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><a href="/img/626593-20190620152059991-2070598653.png" class="gallery-item" style="box-shadow: none;"> <img src="/img/626593-20190620152059991-2070598653.png"></a></p>
<h3 id="添加侧边栏"><a href="#添加侧边栏" class="headerlink" title="添加侧边栏"></a>添加侧边栏</h3><p>想要一个有树状结构的侧边栏，然后给目录、文件、以及搜索框增加图标，需要外部的图片库 。</p>
<p>我的用的图片库是『<a target="_blank" rel="noopener" href="http://fontawesome.dashgame.com/">Font Awesome</a>』。下载好了，放到 source&#x2F;lib 中。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">themes/wiki/</span><br><span class="line">├── _config.yml</span><br><span class="line">├── layout</span><br><span class="line">│   ├── aside.ejs</span><br><span class="line">│   ├── index.ejs</span><br><span class="line">│   ├── layout.ejs</span><br><span class="line">│   ├── nav.ejs</span><br><span class="line">│   └── post.ejs</span><br><span class="line">└── source</span><br><span class="line">    ├── css</span><br><span class="line">    │   └── main.css</span><br><span class="line">    ├── js</span><br><span class="line">    │   └── main.js</span><br><span class="line">    └── lib</span><br><span class="line">        └── font-awesome // 下载好的文字图片库</span><br><span class="line">            ├── css</span><br><span class="line">            ├── fonts</span><br><span class="line">            ├── less</span><br><span class="line">            └── scss</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>在布局文件中，新增字体图片库的 css 文件引用</p>
<p>『layout.ejs』</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;&lt;%- theme.title %&gt;&lt;/title&gt;</span><br><span class="line">    &lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 引入配置文件 --&gt;</span><br><span class="line">    &lt;%- css(&#x27;css/main.css&#x27;) %&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 字体图片库 --&gt;</span><br><span class="line">    &lt;%- css(&#x27;lib/font-awesome/css/font-awesome.min.css&#x27;) %&gt;</span><br><span class="line">    </span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">    &lt;div id=&quot;main&quot;&gt;</span><br><span class="line">        &lt;!-- 引入侧边栏 --&gt;</span><br><span class="line">        &lt;aside&gt;</span><br><span class="line">            &lt;%- include(&#x27;aside.ejs&#x27;) %&gt;</span><br><span class="line">        &lt;/aside&gt;</span><br><span class="line"></span><br><span class="line">        &lt;!-- 引入导航 --&gt;</span><br><span class="line">        &lt;nav&gt;</span><br><span class="line">            &lt;%- include(&#x27;nav.ejs&#x27;) %&gt;</span><br><span class="line">        &lt;/nav&gt;</span><br><span class="line"></span><br><span class="line">        &lt;!-- 引入正文 --&gt;</span><br><span class="line">        &lt;div id=&quot;content&quot;&gt;</span><br><span class="line">            &lt;div id=&quot;article&quot;&gt;</span><br><span class="line">                &lt;%- body %&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        </span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 引入 js 文件 --&gt;</span><br><span class="line">    &lt;%- js(&#x27;js/main.js&#x27;) %&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>添加侧边栏代码，主要做了路径转树的算法，然后显示树。新增了一个搜索框。</p>
<p>『aside.ejs』</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 搜索栏 --&gt;</span><br><span class="line">&lt;div id=&quot;search&quot;&gt;</span><br><span class="line">    &lt;input class=&quot;search-input&quot; type=&quot;text&quot; placeholder=&quot;search&quot;&gt;</span><br><span class="line">    &lt;i class=&quot;fa fa-search&quot;&gt;&lt;/i&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 侧边目录栏 --&gt;</span><br><span class="line">&lt;div id=&quot;tree&quot;&gt;</span><br><span class="line">    &lt;%</span><br><span class="line">        &lt;!-- 将路径转换成 tree 目录结构 --&gt;</span><br><span class="line">        const pathToTree = (input) =&gt; &#123;</span><br><span class="line">            var output = [];</span><br><span class="line">            input.forEach(function(post)&#123;</span><br><span class="line">                &lt;!-- 用来分割去掉时间的路径 --&gt;</span><br><span class="line">                var chain = post.slug.split(&quot;/&quot;);</span><br><span class="line">                var currentNode = output;</span><br><span class="line">                for (var j = 0; j &lt; chain.length; j++) &#123;</span><br><span class="line">                    if (chain[j] === &#x27;&#x27;) &#123;</span><br><span class="line">                        break;</span><br><span class="line">                    &#125;</span><br><span class="line">                    var wantedNode = chain[j];</span><br><span class="line">                    var lastNode = currentNode;</span><br><span class="line"></span><br><span class="line">                    for (var k = 0; k &lt; currentNode.length; k++) &#123;</span><br><span class="line">                        if (currentNode[k].title == wantedNode) &#123;</span><br><span class="line">                            currentNode = currentNode[k].children;</span><br><span class="line">                            break;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    if (lastNode == currentNode) &#123;</span><br><span class="line">                        var newNode = currentNode[k] = &#123; post: post, title: wantedNode, children: [] &#125;;</span><br><span class="line">                        currentNode = newNode.children;</span><br><span class="line">                    &#125; else &#123;</span><br><span class="line">                        delete currentNode.children</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            return output;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        &lt;!-- console.log(output) --&gt;</span><br><span class="line">    %&gt;</span><br><span class="line"></span><br><span class="line">    &lt;%</span><br><span class="line">        &lt;!-- 递归输出侧边栏目录 tree --&gt;</span><br><span class="line">        const showTree = (input) =&gt; &#123;</span><br><span class="line"></span><br><span class="line">            &lt;!-- 按 tile ascii 排序 --&gt;</span><br><span class="line">            input.sort(function(a, b)&#123;</span><br><span class="line">                var len = a.title.length &gt; b.title.length ? a.title.length : b.title.length;</span><br><span class="line">                for ( var i = 0; i &lt; len; i++ ) &#123;</span><br><span class="line">                    res = a.title[i].charCodeAt() - b.title[i].charCodeAt();</span><br><span class="line">                    if ( res ) &#123; return res &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">            &lt;!-- 循环输出 html 结构 --&gt;</span><br><span class="line">            input.forEach(function(node) &#123;</span><br><span class="line">                if ( node.children == 0 ) &#123;</span><br><span class="line"></span><br><span class="line">    %&gt;</span><br><span class="line">                    &lt;ul&gt;</span><br><span class="line">                        &lt;li class=&quot;file&lt;%- (is_post() &amp;&amp; node.post._id == page._id) ? &#x27; active&#x27; : &#x27;&#x27; %&gt;&quot;&gt;</span><br><span class="line">                            &lt;a href=&quot;&lt;%- config.root %&gt;&lt;%- node.post.path %&gt;&quot;&gt;</span><br><span class="line">                                &lt;i class=&quot;fa fa-file&quot;&gt;&lt;/i&gt;</span><br><span class="line">                                &lt;%- node.title %&gt;</span><br><span class="line">                            &lt;/a&gt;</span><br><span class="line">                        &lt;/li&gt;</span><br><span class="line">                    &lt;/ul&gt;</span><br><span class="line">    &lt;%</span><br><span class="line">                &#125;</span><br><span class="line">                else &#123;</span><br><span class="line">    %&gt;</span><br><span class="line">                    &lt;ul&gt;</span><br><span class="line">                        &lt;li class=&quot;directory&quot;&gt;</span><br><span class="line">                            &lt;a href=&quot;#&quot; class=&quot;directory&quot;&gt;</span><br><span class="line">                                &lt;i class=&quot;fa fa-folder&quot;&gt;&lt;/i&gt;</span><br><span class="line">                                &lt;%- node.title %&gt;</span><br><span class="line">                            &lt;/a&gt;</span><br><span class="line">                            &lt;%- showTree(node.children) %&gt;</span><br><span class="line">                        &lt;/li&gt;</span><br><span class="line">                        </span><br><span class="line">                    &lt;/ul&gt;</span><br><span class="line">    &lt;%</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        showTree(pathToTree(site.posts))</span><br><span class="line">    %&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><a href="/img/626593-20190620152124624-1346291648.png" class="gallery-item" style="box-shadow: none;"> <img src="/img/626593-20190620152124624-1346291648.png"></a></p>
<p>在 main.css 文件中，增加侧边栏美化</p>
<p>『main.css』</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">/* #################### 侧边栏 #################### */</span><br><span class="line">/* 搜索框 */</span><br><span class="line">aside input &#123;</span><br><span class="line">    width: 290px;</span><br><span class="line">    height: 50px;</span><br><span class="line">    margin: 0;</span><br><span class="line">    border: 0;</span><br><span class="line">    padding: 0;</span><br><span class="line">    left: 0;</span><br><span class="line">    font-size: 14px;</span><br><span class="line">    background: #131417;</span><br><span class="line">    text-indent: 20px;</span><br><span class="line">    outline: none;</span><br><span class="line">    color: #87daff;</span><br><span class="line">    position: absolute;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* 搜索图标 */</span><br><span class="line">aside #search i.fa.fa-search &#123;</span><br><span class="line">    position: absolute;</span><br><span class="line">    top: 0;</span><br><span class="line">    right: 0;</span><br><span class="line">    color: #757575;</span><br><span class="line">    font-size: 20px;</span><br><span class="line">    width: 40px;</span><br><span class="line">    height: 50px;</span><br><span class="line">    background: #131417;</span><br><span class="line">    text-align: center;</span><br><span class="line">    line-height: 2.5;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* 滚动条 */</span><br><span class="line">aside &#123;</span><br><span class="line">    overflow-y: scroll;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* 树目录位置 */</span><br><span class="line">aside #tree &#123;</span><br><span class="line">    padding-top: 55px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* 树目录 */</span><br><span class="line">aside ul &#123;</span><br><span class="line">    padding: 0px 5px 5px 20px;</span><br><span class="line">&#125;</span><br><span class="line">aside ul li &#123;</span><br><span class="line">    list-style: none;</span><br><span class="line">    line-height: 25px;</span><br><span class="line">&#125;</span><br><span class="line">aside ul li a &#123;</span><br><span class="line">    color: #999;</span><br><span class="line">    font-size: 14px;</span><br><span class="line">    text-decoration: none</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">aside ul li a:hover &#123;</span><br><span class="line">    color: #ccc;</span><br><span class="line">    border-bottom: 1px solid #ccc;</span><br><span class="line">    cursor:pointer;</span><br><span class="line">&#125;</span><br><span class="line">aside #tree .active a,</span><br><span class="line">aside #tree .active a:hover &#123;</span><br><span class="line">    color: #87daff;</span><br><span class="line">    border-bottom: 1px solid #87daff;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">aside #tree i.fa &#123;</span><br><span class="line">    padding-right: 5px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* #################### 侧边栏 #################### */</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><a href="/img/626593-20190620152133949-1696507681.png" class="gallery-item" style="box-shadow: none;"> <img src="/img/626593-20190620152133949-1696507681.png"></a></p>
<h3 id="添加文章"><a href="#添加文章" class="headerlink" title="添加文章"></a>添加文章</h3><p>侧边栏还有搜索功能，和目录折叠功能没实现，这个后面再实现，先把链接里面的内容给搞定，这个时候需要编辑 post.ejs 了</p>
<p>『post.ejs』</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;div&gt;</span><br><span class="line">    &lt;span id=&quot;post-author&quot;&gt;作者: &lt;%- theme.author %&gt;&lt;/span&gt;</span><br><span class="line">    &lt;span id=&quot;post-date&quot;&gt;&lt;%- date(page.date, &quot;YYYY-MM-DD HH:mm:ss&quot;) %&gt;&lt;/span&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;div id=&quot;article&quot;&gt;</span><br><span class="line">    &lt;%- page.content %&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><a href="/img/626593-20190620152139056-1986068911.png" class="gallery-item" style="box-shadow: none;"> <img src="/img/626593-20190620152139056-1986068911.png"></a></p>
<h3 id="图片插件"><a href="#图片插件" class="headerlink" title="图片插件"></a>图片插件</h3><p>可以看到，大致雏形出来了，但是图片都是 404 找不到。</p>
<p><a href="/img/626593-20190620152142489-1373244239.png" class="gallery-item" style="box-shadow: none;"> <img src="/img/626593-20190620152142489-1373244239.png"></a></p>
<p>查看后，发现图片的路径不对。因为我用 『Typora』进行 md 的编写。里面有个设置就是将图片保存在当前文件名命名的同级目录下。</p>
<p><a href="/img/626593-20190620152146221-900560680.png" class="gallery-item" style="box-shadow: none;"> <img src="/img/626593-20190620152146221-900560680.png"></a></p>
<p>因此为了保证 Hexo 的图片与我设置的一致，需要安装一个 NodeJs 插件 『hexo-asset-image』获取文件相对路径下同名文件夹的图片。</p>
<p>返回到 hexo init 的 wiki 目录下进行安装 【<strong>注意: 不是主题的 wiki，是根目录 wiki</strong>】</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm install https://github.com/CodeFalling/hexo-asset-image --save</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>安装好了插件以后，需要在总的配置文件 _config.yml 的第 38 行，将值修改成 true</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 获取文件相对目录的图片</span><br><span class="line">post_asset_folder: true</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>安装好了，重新启动一下 hexo</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">wiki ➔  hexo s</span><br><span class="line">INFO  Start processing</span><br><span class="line">update link as:--&gt;/2019/06/11/Hexo/主题开发/img-20180627190808193.png</span><br><span class="line">update link as:--&gt;/2019/06/11/Hexo/主题开发/img-20190611175811781.png</span><br><span class="line">update link as:--&gt;/2019/06/11/Hexo/主题开发/img-20190611180317902.png</span><br><span class="line">update link as:--&gt;/2019/06/11/Hexo/主题开发/img-20190611180729426.png</span><br><span class="line">update link as:--&gt;/2019/06/11/Hexo/主题开发/img-20190611181023821.png</span><br><span class="line">update link as:--&gt;/2019/06/11/Hexo/主题开发/img-20190611210222968.png</span><br><span class="line">update link as:--&gt;/2019/06/11/Hexo/主题开发/img-20190611212914872.png</span><br><span class="line">update link as:--&gt;/2019/06/11/Hexo/主题开发/img-20190611213529727.png</span><br><span class="line">update link as:--&gt;/2019/06/11/Hexo/主题开发/img-20190611214947308.png</span><br><span class="line">update link as:--&gt;/2019/06/11/Hexo/主题开发/%E5%B8%83%E5%B1%80.png</span><br><span class="line">update link as:--&gt;/2019/06/11/Hexo/主题开发/img-20180627190808193.png</span><br><span class="line">update link as:--&gt;/2019/06/11/Hexo/主题开发/img-20190611175811781.png</span><br><span class="line">update link as:--&gt;/2019/06/11/Hexo/主题开发/img-20190611180317902.png</span><br><span class="line">update link as:--&gt;/2019/06/11/Hexo/主题开发/img-20190611180729426.png</span><br><span class="line">update link as:--&gt;/2019/06/11/Hexo/主题开发/img-20190611181023821.png</span><br><span class="line">update link as:--&gt;/2019/06/11/Hexo/主题开发/img-20190611210222968.png</span><br><span class="line">update link as:--&gt;/2019/06/11/Hexo/主题开发/img-20190611212914872.png</span><br><span class="line">update link as:--&gt;/2019/06/11/Hexo/主题开发/img-20190611213529727.png</span><br><span class="line">update link as:--&gt;/2019/06/11/Hexo/主题开发/img-20190611214947308.png</span><br><span class="line">update link as:--&gt;/2019/06/11/Hexo/主题开发/%E5%B8%83%E5%B1%80.png</span><br><span class="line">update link as:--&gt;/2018/06/27/Hexo/安装/img-20180627190808193.png</span><br><span class="line">update link as:--&gt;/2018/06/27/Hexo/安装/img-20180627190808193.png</span><br><span class="line">update link as:--&gt;/2018/01/17/Docker/镜像部署/CentOS/success.png</span><br><span class="line">update link as:--&gt;/2018/01/17/Docker/镜像部署/CentOS/success.png</span><br><span class="line">INFO  Hexo is running at http://localhost:4000 . Press Ctrl+C to stop.</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>看日志，发现他已经在更新我的图片了，看一眼 Blog 图片就已经出来了，不再是 404 了。</p>
<p><a href="/img/626593-20190620152155240-1813969534.png" class="gallery-item" style="box-shadow: none;"> <img src="/img/626593-20190620152155240-1813969534.png"></a></p>
<p>仔细看文件路径，在我 『主题开发. md』文件的同级，有个名字叫『主题开发』的文件夹，里面存着我引用的图片资源，这样的路径，才能被这个插件给加载出来。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">├── Hexo</span><br><span class="line">│       │   ├── 安装</span><br><span class="line">│       │   │   ├── img-20180627184245526.png</span><br><span class="line">│       │   │   ├── img-20180627190554905.png</span><br><span class="line">│       │   │   └── img-20180627190808193.png</span><br><span class="line">│       │   ├── 安装.md</span><br><span class="line">│       │   ├── 主题开发</span><br><span class="line">│       │   │   ├── img-20180627190808193.png</span><br><span class="line">│       │   │   ├── img-20190611175811781.png</span><br><span class="line">│       │   │   ├── img-20190611180317902.png</span><br><span class="line">│       │   │   ├── img-20190611180729426.png</span><br><span class="line">│       │   │   ├── img-20190611181023821.png</span><br><span class="line">│       │   │   ├── img-20190611210222968.png</span><br><span class="line">│       │   │   ├── img-20190611212914872.png</span><br><span class="line">│       │   │   ├── img-20190611213529727.png</span><br><span class="line">│       │   │   ├── img-20190611214947308.png</span><br><span class="line">│       │   │   └── 布局.png</span><br><span class="line">│       │   └── 主题开发.md</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="代码高亮"><a href="#代码高亮" class="headerlink" title="代码高亮"></a>代码高亮</h3><p>剩下的就是给文章做 css 美化了，当然，美化一定要代码高亮了。我用的代码高亮是比较流行的 『<a target="_blank" rel="noopener" href="https://highlightjs.org/">highlightjs</a>』下载了其中我非常喜欢的 『<a target="_blank" rel="noopener" href="https://highlightjs.org/download/">atom-one-dark</a>』的主题。如果有自己更喜欢的主题，可以根据自己的喜好进行下载。</p>
<p>跟图片库『font-awesome』一样，也把它放进 source&#x2F;lib 中</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">themes/wiki/source/</span><br><span class="line">├── css</span><br><span class="line">│   └── main.css</span><br><span class="line">├── js</span><br><span class="line">│   └── main.js</span><br><span class="line">└── lib</span><br><span class="line">    ├── font-awesome</span><br><span class="line">    └── highlight</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>在 『laout.ejs』中，引入它的 css 与 js，引入后，记得让高亮加载</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;&lt;%- theme.title %&gt;&lt;/title&gt;</span><br><span class="line">    &lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 引入配置文件 --&gt;</span><br><span class="line">    &lt;%- css(&#x27;css/main.css&#x27;) %&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 字体图片库 --&gt;</span><br><span class="line">    &lt;%- css(&#x27;lib/font-awesome/css/font-awesome.min.css&#x27;) %&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 代码高亮库 --&gt;</span><br><span class="line">    &lt;%- css(&#x27;/lib/highlight/styles/atom-one-dark&#x27;) %&gt;</span><br><span class="line">    </span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">    &lt;div id=&quot;main&quot;&gt;</span><br><span class="line">        &lt;!-- 引入侧边栏 --&gt;</span><br><span class="line">        &lt;aside&gt;</span><br><span class="line">            &lt;%- include(&#x27;aside.ejs&#x27;) %&gt;</span><br><span class="line">        &lt;/aside&gt;</span><br><span class="line"></span><br><span class="line">        &lt;!-- 引入导航 --&gt;</span><br><span class="line">        &lt;nav&gt;</span><br><span class="line">            &lt;%- include(&#x27;nav.ejs&#x27;) %&gt;</span><br><span class="line">        &lt;/nav&gt;</span><br><span class="line"></span><br><span class="line">        &lt;!-- 引入正文 --&gt;</span><br><span class="line">        &lt;div id=&quot;content&quot;&gt;</span><br><span class="line">            &lt;%- body %&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        </span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 引入 js 文件 --&gt;</span><br><span class="line">    &lt;%- js(&#x27;js/main.js&#x27;) %&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 引入代码高亮的 js --&gt;</span><br><span class="line">    &lt;%- js(&#x27;/lib/highlight/highlight.pack.js&#x27;) %&gt;</span><br><span class="line">    &lt;script&gt;hljs.initHighlightingOnLoad();&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><a href="/img/626593-20190620152207611-326933918.png" class="gallery-item" style="box-shadow: none;"> <img src="/img/626593-20190620152207611-326933918.png"></a></p>
<p>发现代码并没有高亮，找了下原因，原来是默认主题已经是 『highlight』代码高亮了，但是它的这些并不够炫酷，还是选择坚持用我自己下载的，所以我必须得去总配置文件 _config.yml 里面，把它给关闭，大概在 42 行的位置，将这 3 个选项关闭。</p>
<p>『_config.yml』</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">highlight:</span><br><span class="line">  enable: false</span><br><span class="line">  line_number: false</span><br><span class="line">  auto_detect: false</span><br><span class="line">  tab_replace:</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>修改配置文件以后，得重启 hexo 在重启前，先 hexo clean 以免还有缓存在。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hexo clean</span><br><span class="line">hexo s</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><a href="/img/626593-20190620152211753-1928277802.png" class="gallery-item" style="box-shadow: none;"> <img src="/img/626593-20190620152211753-1928277802.png"></a></p>
<p>代码出现高亮了，现在美化文章，增加 css</p>
<p>『main.css』</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br></pre></td><td class="code"><pre><span class="line">/* #################### 文章 #################### */</span><br><span class="line">/* 作者 时间 相关 */</span><br><span class="line">#post-author &#123;</span><br><span class="line">    font-size: 9px;</span><br><span class="line">    position: absolute;</span><br><span class="line">    top: 60px;</span><br><span class="line">    right: 30px;</span><br><span class="line">    color: #999;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#post-date &#123;</span><br><span class="line">    font-size: 9px;</span><br><span class="line">    position: absolute;</span><br><span class="line">    top: 80px;</span><br><span class="line">    right: 30px;</span><br><span class="line">    color: #999;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* 文章各个元素间隔 */</span><br><span class="line">#article &#123;</span><br><span class="line">    padding: 30px;</span><br><span class="line">&#125;</span><br><span class="line">#article * &#123;</span><br><span class="line">    margin: 30px 0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#article h1,</span><br><span class="line">#article h2,</span><br><span class="line">#article h3,</span><br><span class="line">#article h4,</span><br><span class="line">#article h5,</span><br><span class="line">#article h6 &#123;</span><br><span class="line">    line-height: 40px;</span><br><span class="line">    margin: 20px 0 15px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#article h1 &#123;</span><br><span class="line">    font-size: 32px;</span><br><span class="line">    font-weight: 900;</span><br><span class="line">    padding-bottom: 10px;</span><br><span class="line">    border-bottom: 2px solid #e06c75;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#article h2 &#123;</span><br><span class="line">    font-size: 25px;</span><br><span class="line">    border-left: 3px solid #73b1e0;</span><br><span class="line">    padding-left: 10px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#article h3 &#123;</span><br><span class="line">    font-size: 22px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#article a &#123;</span><br><span class="line">    color: #e06c75;</span><br><span class="line">    text-decoration: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#article a:hover &#123;</span><br><span class="line">    border-bottom: 1px solid;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#article h1 a:hover&#123;</span><br><span class="line">    border-bottom: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#article code &#123;</span><br><span class="line">    border-radius: 3px;</span><br><span class="line">    box-shadow: 0px 0px 5px #999;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#article img &#123;</span><br><span class="line">    max-width: 100%;</span><br><span class="line">    height: auto;</span><br><span class="line">    border-radius: 5px;</span><br><span class="line">    box-shadow: 0px 0px 8px #999;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#article pre &#123;</span><br><span class="line">    font-size: 14px;</span><br><span class="line">    margin: 20px 0 15px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#article p &#123;</span><br><span class="line">    margin: 0 0 10px;</span><br><span class="line">    line-height: 30px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* 表格处理 */</span><br><span class="line">#article table &#123;</span><br><span class="line">  width: 100%;</span><br><span class="line">  border: 0;</span><br><span class="line">  margin: 20px 0 50px 0;</span><br><span class="line">  border-collapse: collapse;</span><br><span class="line">  border-spacing: 0;</span><br><span class="line">  line-height: 35px;</span><br><span class="line">  border-radius: 8px;</span><br><span class="line">  box-shadow: 0px 0px 5px #999;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#article table th &#123;</span><br><span class="line">  background: #73b1e0;</span><br><span class="line">  font-weight: 800;</span><br><span class="line">  font-size: 18px;</span><br><span class="line">  text-align: left;</span><br><span class="line">  line-height: 35px;</span><br><span class="line">  color: #FFF;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#article table tr:nth-child(odd) &#123;</span><br><span class="line">  background: #F4F4F4;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#article table tr:hover,</span><br><span class="line">#article table td:hover &#123;</span><br><span class="line">  background: #badbf5;</span><br><span class="line">  color: #FFF;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#article table td, table th &#123;</span><br><span class="line">  padding: 5px 20px 5px 20px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#article table tr:first-child th:first-child &#123;</span><br><span class="line">  border-top-left-radius: 3px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#article table tr:first-child th:last-child &#123;</span><br><span class="line">  border-top-right-radius: 3px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#article table tr:last-child td:first-child &#123;</span><br><span class="line">  border-bottom-left-radius: 3px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#article table tr:last-child td:last-child &#123;</span><br><span class="line">  border-bottom-right-radius: 3px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* #################### 文章 #################### */</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><a href="/img/626593-20190620152226032-618387805.png" class="gallery-item" style="box-shadow: none;"> <img src="/img/626593-20190620152226032-618387805.png"></a></p>
<h3 id="目录点击事件"><a href="#目录点击事件" class="headerlink" title="目录点击事件"></a>目录点击事件</h3><p>到这个时候，就需要编写 js 了。我使用了 jQuery 库，本来不准备用第三方插件了，后面发现，早晚都要用，干脆一开始就使用好了。</p>
<p>下载 <a target="_blank" rel="noopener" href="https://jquery.com/download/">jQuery</a> 库，放到 sorce&#x2F;lib 中</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">themes/wiki/source/</span><br><span class="line">├── css</span><br><span class="line">│   └── main.css</span><br><span class="line">├── js</span><br><span class="line">│   └── main.js</span><br><span class="line">└── lib</span><br><span class="line">    ├── font-awesome</span><br><span class="line">    ├── highlight</span><br><span class="line">    └── jquery-3.4.1.min.js</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>在 layout.ejs 中引入 jquery 库，这里得注意，要先引用 jquery 再引入自己的 js 代码，否则在编写的时候，找不到 jqeury 库。因为 html 在编译的时候，是从上往下顺序执行的，如果不先引入库文件，在自己的代码中就找不到库文件了。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;&lt;%- theme.title %&gt;&lt;/title&gt;</span><br><span class="line">    &lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 引入配置文件 --&gt;</span><br><span class="line">    &lt;%- css(&#x27;css/main.css&#x27;) %&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 字体图片库 --&gt;</span><br><span class="line">    &lt;%- css(&#x27;lib/font-awesome/css/font-awesome.min.css&#x27;) %&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 代码高亮库 --&gt;</span><br><span class="line">    &lt;%- css(&#x27;/lib/highlight/styles/atom-one-dark&#x27;) %&gt;</span><br><span class="line">    </span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">    &lt;div id=&quot;main&quot;&gt;</span><br><span class="line">        &lt;!-- 引入侧边栏 --&gt;</span><br><span class="line">        &lt;aside&gt;</span><br><span class="line">            &lt;%- include(&#x27;aside.ejs&#x27;) %&gt;</span><br><span class="line">        &lt;/aside&gt;</span><br><span class="line"></span><br><span class="line">        &lt;!-- 引入导航 --&gt;</span><br><span class="line">        &lt;nav&gt;</span><br><span class="line">            &lt;%- include(&#x27;nav.ejs&#x27;) %&gt;</span><br><span class="line">        &lt;/nav&gt;</span><br><span class="line"></span><br><span class="line">        &lt;!-- 引入正文 --&gt;</span><br><span class="line">        &lt;div id=&quot;content&quot;&gt;</span><br><span class="line">            &lt;%- body %&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        </span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 引入代码高亮的 js --&gt;</span><br><span class="line">    &lt;%- js(&#x27;/lib/highlight/highlight.pack.js&#x27;) %&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 引入 jquery --&gt;</span><br><span class="line">    &lt;%- js(&#x27;/lib/jquery-3.4.1.min.js&#x27;) %&gt;</span><br><span class="line">    &lt;script&gt;hljs.initHighlightingOnLoad();&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 引入 js 文件 --&gt;</span><br><span class="line">    &lt;%- js(&#x27;js/main.js&#x27;) %&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>接着就是编写自己的 js 了。代码大致意识，都写在注释里了。</p>
<p>『main.js』</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">$(document).ready(function () &#123;</span><br><span class="line">    clickTreeDirectory();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// 点击目录事件</span><br><span class="line">function clickTreeDirectory() &#123;</span><br><span class="line">    // 判断有 active 的话，就递归循环把它的父目录打开</span><br><span class="line">    var treeActive = $(&quot;#tree .active&quot;);</span><br><span class="line">    if ( treeActive.length ) &#123;</span><br><span class="line">        showActiveTree(treeActive, true);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 点击目录，就触发折叠动画效果</span><br><span class="line">    $(document).on(&quot;click&quot;, &quot;#tree a[class=&#x27;directory&#x27;]&quot;, function (e) &#123;</span><br><span class="line">        // 用来清空所有绑定的其他事件</span><br><span class="line">        event.preventDefault();</span><br><span class="line"></span><br><span class="line">        var icon = $(this).children(&quot;.fa&quot;);</span><br><span class="line">        var iconIsOpen = icon.hasClass(&quot;fa-folder-open&quot;);</span><br><span class="line">        var subTree = $(this).siblings(&quot;ul&quot;);</span><br><span class="line"></span><br><span class="line">        icon.removeClass(&quot;fa-folder-open&quot;).removeClass(&quot;fa-folder&quot;);</span><br><span class="line"></span><br><span class="line">        if (iconIsOpen) &#123;</span><br><span class="line">            if (typeof subTree != &quot;undefined&quot;) &#123;</span><br><span class="line">                subTree.slideUp(&#123; duration: 100 &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">            icon.addClass(&quot;fa-folder&quot;);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            if (typeof subTree != &quot;undefined&quot;) &#123;</span><br><span class="line">                subTree.slideDown(&#123; duration: 100 &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">            icon.addClass(&quot;fa-folder-open&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 循环递归展开父节点</span><br><span class="line">function showActiveTree(jqNode, isSiblings) &#123;</span><br><span class="line">    if ( jqNode.attr(&quot;id&quot;) === &quot;tree&quot;  ) &#123; return; &#125;</span><br><span class="line">    if ( jqNode.is(&quot;ul&quot;) ) &#123;</span><br><span class="line">        jqNode.css(&quot;display&quot;, &quot;block&quot;);</span><br><span class="line"></span><br><span class="line">        // 这个 isSiblings 是给搜索用的</span><br><span class="line">        // true 就显示开同级兄弟节点</span><br><span class="line">        // false 就是给搜索用的，值需要展示它自己就好了，不展示兄弟节点</span><br><span class="line">        if ( isSiblings ) &#123; </span><br><span class="line">            jqNode.siblings().css(&quot;display&quot;, &quot;block&quot;);</span><br><span class="line">            jqNode.siblings(&quot;a&quot;).css(&quot;display&quot;, &quot;inline&quot;);</span><br><span class="line">            jqNode.siblings(&quot;a&quot;).find(&quot;.fa-folder&quot;).removeClass(&quot;fa-folder&quot;).addClass(&quot;fa-folder-open&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    jqNode.each(function()&#123; showActiveTree($(this).parent(), isSiblings); &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><a href="/img/626593-20190620152246406-1895807719.png" class="gallery-item" style="box-shadow: none;"> <img src="/img/626593-20190620152246406-1895807719.png"></a></p>
<h3 id="搜索"><a href="#搜索" class="headerlink" title="搜索"></a>搜索</h3><p>这个搜索框一开始就设计好了，但是没有什么功能。要是做全文本搜索的话，就需要安装插件了。这里只是简单的在侧边栏的文章目录上进行搜索。在 js 代码中增加以下。</p>
<p>『main.js』</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">// 搜索框输入事件</span><br><span class="line">function serachTree() &#123;</span><br><span class="line">    // 解决搜索大小写问题</span><br><span class="line">    jQuery.expr[&#x27;:&#x27;].contains = function (a, i, m) &#123;</span><br><span class="line">        return jQuery(a).text().toUpperCase().indexOf(m[3].toUpperCase()) &gt;= 0;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    $(&quot;#search input&quot;).on(&quot;input&quot;, function(e)&#123;</span><br><span class="line">        e.preventDefault();</span><br><span class="line"></span><br><span class="line">        // 获取 inpiut 输入框的内容</span><br><span class="line">        var inputContent = e.currentTarget.value;</span><br><span class="line"></span><br><span class="line">        // 没值就收起父目录，但是得把 active 的父目录都展开</span><br><span class="line">        if ( inputContent.length === 0 ) &#123;</span><br><span class="line">            $(&quot;.fa-folder-open&quot;).removeClass(&quot;fa-folder-open&quot;).addClass(&quot;fa-folder&quot;);</span><br><span class="line">            $(&quot;#tree ul&quot;).css(&quot;display&quot;, &quot;none&quot;);</span><br><span class="line">            if ( $(&quot;#tree .active&quot;).length ) &#123;</span><br><span class="line">                showActiveTree($(&quot;#tree .active&quot;), true);</span><br><span class="line">            &#125;</span><br><span class="line">            else &#123;</span><br><span class="line">                $(&quot;#tree&quot;).children().css(&quot;display&quot;, &quot;block&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        // 有值就搜索，并且展开父目录</span><br><span class="line">        else &#123;</span><br><span class="line">            $(&quot;.fa-folder&quot;).removeClass(&quot;fa-folder&quot;).addClass(&quot;fa-folder-open&quot;);</span><br><span class="line">            $(&quot;#tree ul&quot;).css(&quot;display&quot;, &quot;none&quot;);</span><br><span class="line">            var searchResult = $(&quot;#tree li&quot;).find(&quot;a:contains(&#x27;&quot; + inputContent + &quot;&#x27;)&quot;);</span><br><span class="line">            if ( searchResult.length ) &#123; </span><br><span class="line">                showActiveTree(searchResult.parent(), false) </span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><a href="/img/626593-20190620152258672-542006097.png" class="gallery-item" style="box-shadow: none;"> <img src="/img/626593-20190620152258672-542006097.png"></a></p>
<h3 id="局部刷新"><a href="#局部刷新" class="headerlink" title="局部刷新"></a>局部刷新</h3><p>发现搜索出来东西以后，点击搜索的连接，页面会闪一下，然后我的树状结构目录就变了，作为测试的我，这种 bug 不能忍呀。琢磨了很久，想到可以使用 ajax 做局部刷新。就是刷新下图中的局部区域。</p>
<p><a href="/img/626593-20190620152302464-1857683603.png" class="gallery-item" style="box-shadow: none;"> <img src="/img/626593-20190620152302464-1857683603.png"></a></p>
<p>网上搜索以后，发现已经有现成的东西了它叫做 『 <a target="_blank" rel="noopener" href="https://github.com/defunkt/jquery-pjax">pjax</a> 』，下载后放进 source&#x2F;lib 中，在布局中引用，在 js 里新增逻辑。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">themes/wiki/source/</span><br><span class="line">├── css</span><br><span class="line">│   └── main.css</span><br><span class="line">├── js</span><br><span class="line">│   └── main.js</span><br><span class="line">└── lib</span><br><span class="line">    ├── font-awesome</span><br><span class="line">    ├── highlight</span><br><span class="line">    ├── jquery-3.4.1.min.js</span><br><span class="line">    └── jquery.pjax.js</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>『layout.ejs』</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;&lt;%- theme.title %&gt;&lt;/title&gt;</span><br><span class="line">    &lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 引入配置文件 --&gt;</span><br><span class="line">    &lt;%- css(&#x27;css/main.css&#x27;) %&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 字体图片库 --&gt;</span><br><span class="line">    &lt;%- css(&#x27;lib/font-awesome/css/font-awesome.min.css&#x27;) %&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 代码高亮库 --&gt;</span><br><span class="line">    &lt;%- css(&#x27;/lib/highlight/styles/atom-one-dark&#x27;) %&gt;</span><br><span class="line">    </span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">    &lt;div id=&quot;main&quot;&gt;</span><br><span class="line">        &lt;!-- 引入侧边栏 --&gt;</span><br><span class="line">        &lt;aside&gt;</span><br><span class="line">            &lt;%- include(&#x27;aside.ejs&#x27;) %&gt;</span><br><span class="line">        &lt;/aside&gt;</span><br><span class="line"></span><br><span class="line">        &lt;!-- 引入导航 --&gt;</span><br><span class="line">        &lt;nav&gt;</span><br><span class="line">            &lt;%- include(&#x27;nav.ejs&#x27;) %&gt;</span><br><span class="line">        &lt;/nav&gt;</span><br><span class="line"></span><br><span class="line">        &lt;!-- 引入正文 --&gt;</span><br><span class="line">        &lt;div id=&quot;content&quot;&gt;</span><br><span class="line">            &lt;%- body %&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        </span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 引入代码高亮的 js --&gt;</span><br><span class="line">    &lt;%- js(&#x27;/lib/highlight/highlight.pack.js&#x27;) %&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 引入 jquery --&gt;</span><br><span class="line">    &lt;%- js(&#x27;/lib/jquery-3.4.1.min.js&#x27;) %&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 引入 pjax --&gt;</span><br><span class="line">    &lt;%- js(&#x27;/lib/jquery.pjax.js&#x27;) %&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;!-- 引入 js 文件 --&gt;</span><br><span class="line">    &lt;%- js(&#x27;js/main.js&#x27;) %&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>『main.js』</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">$(document).ready(function () &#123;</span><br><span class="line">    clickTreeDirectory();</span><br><span class="line">    serachTree();</span><br><span class="line">    pjaxLoad();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">function pjaxLoad()&#123;</span><br><span class="line">    $(document).pjax(&#x27;#tree a&#x27;, &#x27;#content&#x27;, &#123;fragment:&#x27;#content&#x27;, timeout:8000&#125;);</span><br><span class="line">    $(document).pjax(&#x27;#menu a&#x27;, &#x27;#content&#x27;, &#123;fragment:&#x27;#content&#x27;, timeout:8000&#125;);</span><br><span class="line">    $(document).on(&#123;</span><br><span class="line">        &quot;pjax:complete&quot;: function(e) &#123;</span><br><span class="line">            $(&quot;pre code&quot;).each(function (i, block)&#123;</span><br><span class="line">                hljs.highlightBlock(block);</span><br><span class="line">            &#125;);</span><br><span class="line">            </span><br><span class="line">            // 添加 active</span><br><span class="line">            $(&quot;#tree .active&quot;).removeClass(&quot;active&quot;);</span><br><span class="line">            e.relatedTarget.parentNode.classList.add(&quot;active&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="文章索引目录"><a href="#文章索引目录" class="headerlink" title="文章索引目录"></a>文章索引目录</h3><p>文章的索引目录，可以根据文章的 h1 h2 h3 标签，把他们给弄出来，然后分级自动生成目录。</p>
<p>首先在 aside.ejs 做一个存放目录的 div，先试试目录好不好用。</p>
<p>『aside.ejs』</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">&lt;!-- 最尾部添加，这里就不列以前的代码了 --&gt;</span><br><span class="line">&lt;div id=&quot;toc&quot;&gt;&lt;/div&gt;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>我想在我点击目录链接的时候，文章滑动至我想看的位置，并且在文章滑动过的位置，导航都标记已读的状态。加入 js 代码。先丢进 aside 的 toc 中测试一下。</p>
<p>『main.js』</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line">$(document).ready(function () &#123;</span><br><span class="line">    hljs.initHighlightingOnLoad();</span><br><span class="line">    clickTreeDirectory();</span><br><span class="line">    serachTree();</span><br><span class="line">    pjaxLoad();</span><br><span class="line">    showArticleIndex();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">function showArticleIndex() &#123;</span><br><span class="line">    // 先刷一遍文章有哪些节点，把 h1 h2 h3 加入列表，等下循环进行处理。</span><br><span class="line">    // 如果不够，可以加上 h4 ,只是我个人觉得，前 3 个就够了，出现第 4 层就目录就太长了，太细节了。</span><br><span class="line">    var h1List = h2List = h3List = [];</span><br><span class="line">    var labelList = $(&quot;#article&quot;).children();</span><br><span class="line">    for ( var i=0; i&lt;labelList.length; i++ ) &#123;</span><br><span class="line">        if ( $(labelList[i]).is(&quot;h1&quot;) ) &#123;</span><br><span class="line">            h2List = new Array();</span><br><span class="line">            h1List.push(&#123;node: $(labelList[i]), id: i, children: h2List&#125;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        if ( $(labelList[i]).is(&quot;h2&quot;) ) &#123;</span><br><span class="line">            h3List = new Array();</span><br><span class="line">            h2List.push(&#123;node: $(labelList[i]), id: i, children: h3List&#125;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        if ( $(labelList[i]).is(&quot;h3&quot;) ) &#123;</span><br><span class="line">            h3List.push(&#123;node: $(labelList[i]), id: i, children: []&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 闭包递归，返回树状 html 格式的文章目录索引</span><br><span class="line">    function show(tocList) &#123;</span><br><span class="line">        var content = &quot;&lt;ul&gt;&quot;;</span><br><span class="line">        tocList.forEach(function (toc) &#123;</span><br><span class="line">            toc.node.before(&#x27;&lt;span class=&quot;anchor&quot; id=&quot;_label&#x27;+toc.id+&#x27;&quot;&gt;&lt;/span&gt;&#x27;);</span><br><span class="line">            if ( toc.children == 0 ) &#123;</span><br><span class="line">                content += &#x27;&lt;li&gt;&lt;a href=&quot;#_label&#x27;+toc.id+&#x27;&quot;&gt;&#x27;+toc.node.text()+&#x27;&lt;/a&gt;&lt;/li&gt;&#x27;;</span><br><span class="line">            &#125;</span><br><span class="line">            else &#123;</span><br><span class="line">                content += &#x27;&lt;li&gt;&lt;a href=&quot;#_label&#x27;+toc.id+&#x27;&quot;&gt;&#x27;+toc.node.text()+&#x27;&lt;/a&gt;&#x27;+show(toc.children)+&#x27;&lt;/li&gt;&#x27;;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        content += &quot;&lt;/ul&gt;&quot;</span><br><span class="line">        return content;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  // 最后组合成 div 方便 css 设计样式，添加到指定位置</span><br><span class="line">    $(&quot;aside #toc&quot;).empty();</span><br><span class="line">    $(&quot;aside #toc&quot;).append(show(h1List));</span><br><span class="line"></span><br><span class="line">    // 点击目录索引链接，动画跳转过去，不是默认闪现过去</span><br><span class="line">    $(&quot;#toc a&quot;).on(&quot;click&quot;, function(e)&#123;</span><br><span class="line">        e.preventDefault();</span><br><span class="line">        // 获取当前点击的 a 标签，并前触发滚动动画往对应的位置</span><br><span class="line">        var target = $(this.hash);</span><br><span class="line">        $(&quot;body, html&quot;).animate(</span><br><span class="line">            &#123;&#x27;scrollTop&#x27;: target.offset().top&#125;,</span><br><span class="line">            500</span><br><span class="line">        );</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    // 监听浏览器滚动条，当浏览过的标签，给他上色。</span><br><span class="line">    $(window).on(&quot;scroll&quot;, function(e)&#123;</span><br><span class="line">        var anchorList = $(&quot;.anchor&quot;);</span><br><span class="line">        anchorList.each(function()&#123;</span><br><span class="line">            var tocLink = $(&#x27;#toc a[href=&quot;#&#x27;+$(this).attr(&quot;id&quot;)+&#x27;&quot;]&#x27;);</span><br><span class="line">            var anchorTop = $(this).offset().top;</span><br><span class="line">            var windowTop = $(window).scrollTop();</span><br><span class="line">            if ( anchorTop &lt;= windowTop+50 ) &#123;</span><br><span class="line">                tocLink.addClass(&quot;read&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">            else &#123;</span><br><span class="line">                tocLink.removeClass(&quot;read&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>新增 css 样式，用来支撑滚动已读状态的。</p>
<p>『main.css』</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">/* #################### 文章索引 #################### */</span><br><span class="line"></span><br><span class="line">aside #toc a.read&#123;</span><br><span class="line">    /*color: #e06c75;*/</span><br><span class="line">    color: #87daff;</span><br><span class="line">    border-bottom: 0;</span><br><span class="line">    -webkit-transition: 0.5s;</span><br><span class="line">    -moz-transition: 0.5s;</span><br><span class="line">    -ms-transition: 0.5s;</span><br><span class="line">    -o-transition: 0.5s;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">aside #toc a&#123;</span><br><span class="line">    color: #999;</span><br><span class="line">    border-bottom: 0;</span><br><span class="line">    -webkit-transition: 0.2s;</span><br><span class="line">    -moz-transition: 0.2s;</span><br><span class="line">    -ms-transition: 0.2s;</span><br><span class="line">    -o-transition: 0.2s;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">aside #toc a:hover&#123;</span><br><span class="line">    /*color: #87daff;*/</span><br><span class="line">    color: #e5c07b;</span><br><span class="line">    padding-left: 20px;</span><br><span class="line">    -webkit-transition: 0.1s;</span><br><span class="line">    -moz-transition: 0.1s;</span><br><span class="line">    -ms-transition: 0.1s;</span><br><span class="line">    -o-transition: 0.1s;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* #################### 文章索引 #################### */</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><a href="/img/626593-20190620152343097-1318795664.png" class="gallery-item" style="box-shadow: none;"> <img src="/img/626593-20190620152343097-1318795664.png"></a></p>
<p>本来想着 wiki 这种不需要文章目录索引的。但是万一文章真的很长呢？好歹得有个目录吧，还是有个目录方便点。初期布局的时候，就没有想过目录要放哪，这下尴尬了。放在这个位置吧，还是有点丑，想点办法把这个目录优化一下，想着左上方的搜索图标没啥用，换成按钮好了，当点击时，分别切换文章索引目录，与树目录。</p>
<p>修改 aside.ejs ，把这个搜索图标，加个 id</p>
<p>『aside.ejs』</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 搜索栏 --&gt;</span><br><span class="line">&lt;div id=&quot;search&quot;&gt;</span><br><span class="line">    &lt;input class=&quot;search-input&quot; type=&quot;text&quot; placeholder=&quot;search&quot;&gt;</span><br><span class="line">    &lt;i class=&quot;fa fa-search&quot;&gt;&lt;/i&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>修改如下</p>
<p>『aside.ejs』</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 搜索栏 --&gt;</span><br><span class="line">&lt;div id=&quot;search&quot;&gt;</span><br><span class="line">    &lt;input class=&quot;search-input&quot; type=&quot;text&quot; placeholder=&quot;search&quot;&gt;</span><br><span class="line">    &lt;i id=&quot;search-icon&quot; class=&quot;fa fa-bars&quot; title=&quot;切换目录与索引&quot;&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>然后给它实现 js 事件。</p>
<p>『main.js』</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">$(document).ready(function () &#123;</span><br><span class="line">    hljs.initHighlightingOnLoad();</span><br><span class="line">    clickTreeDirectory();</span><br><span class="line">    serachTree();</span><br><span class="line">    pjaxLoad();</span><br><span class="line">    showArticleIndex();</span><br><span class="line">    switchTreeOrIndex();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// 点击搜索旁的按钮，切换目录与索引</span><br><span class="line">function switchTreeOrIndex()&#123;</span><br><span class="line">    $(&quot;#search-icon&quot;).on(&quot;click&quot;, function(e)&#123;</span><br><span class="line">        $(&quot;#tree&quot;).animate(&#123;height:&#x27;toggle&#x27;&#125;,0);</span><br><span class="line">        $(&quot;#toc&quot;).animate(&#123;height:&#x27;toggle&#x27;&#125;,0);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>修改 css 给图标加上一个选中状态，大概 70 行的位置，以前是对 i 标签进行设置的，现在换成 id ，并且对它的 hover 选中状态进行变色。</p>
<p>『main.css』</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">/* 搜索图标 */</span><br><span class="line">aside #search #search-icon &#123;</span><br><span class="line">    position: absolute;</span><br><span class="line">    top: 0;</span><br><span class="line">    right: 0;</span><br><span class="line">    color: #999;</span><br><span class="line">    font-size: 20px;</span><br><span class="line">    width: 40px;</span><br><span class="line">    height: 50px;</span><br><span class="line">    background: #131417;</span><br><span class="line">    text-align: center;</span><br><span class="line">    line-height: 2.5;</span><br><span class="line">    text-decoration: none</span><br><span class="line">&#125;</span><br><span class="line">aside #search #search-icon:hover &#123;</span><br><span class="line">    cursor: pointer;</span><br><span class="line">    color: #87daff;</span><br><span class="line">    -webkit-user-select: none;</span><br><span class="line">  -moz-user-select: none;</span><br><span class="line">  -ms-user-select: none;</span><br><span class="line">  -o-user-select: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><a href="/img/626593-20190620152355866-1709605003.png" class="gallery-item" style="box-shadow: none;"> <img src="/img/626593-20190620152355866-1709605003.png"></a></p>
<p>好了，现在点击这个图标，就会切换目录或者索引了。就是图标选的不太好，可以选中把图标换掉。如果想要更多的图标，可以去『<a target="_blank" rel="noopener" href="http://fontawesome.dashgame.com/#new">Font Awesome</a>』找喜欢的。</p>
<p>『aside.ejs』</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 搜索栏 --&gt;</span><br><span class="line">&lt;div id=&quot;search&quot;&gt;</span><br><span class="line">    &lt;input class=&quot;search-input&quot; type=&quot;text&quot; placeholder=&quot;search&quot;&gt;</span><br><span class="line">    &lt;i id=&quot;search-icon&quot; class=&quot;fa fa-bars&quot; title=&quot;切换目录与索引&quot;&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><a href="/img/626593-20190620152401652-1836957731.png" class="gallery-item" style="box-shadow: none;"> <img src="/img/626593-20190620152401652-1836957731.png"></a></p>
<h3 id="主页"><a href="#主页" class="headerlink" title="主页"></a>主页</h3><p>其实主页可以直接引用最喜欢的 md 文件，就是主页了。后面的关于是直接引用的，为了本文每块都不一样，我这里把 wiki 文章列一下，形成一个全局文章浏览好了。如果你的文章特别的多，这种方式很影响网络带宽的，如果网络不是足够的大，很容易造成卡顿。</p>
<p>『index.ejs』</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=&quot;articleList&quot;&gt;</span><br><span class="line">    &lt;ul&gt;</span><br><span class="line">        &lt;% site.posts.forEach(function(post)&#123; %&gt;</span><br><span class="line"></span><br><span class="line">            &lt;li class=&quot;article-li&quot;&gt;</span><br><span class="line">                &lt;span class=&quot;article-date&quot;&gt;&lt;%- date(post.date, &quot;YYYY-MM-DD&quot;) %&gt;&lt;/span&gt;</span><br><span class="line">                &lt;a class=&quot;article-read&quot; href=&quot;&lt;%- config.root %&gt;&lt;%- post.path %&gt;&quot;&gt; 阅读全文 &lt;/span&gt;</span><br><span class="line">                &lt;a class=&quot;article-title&quot; href=&quot;&lt;%- config.root %&gt;&lt;%- post.path %&gt;&quot;&gt;&lt;%- post.slug.split(&quot;/&quot;)[post.slug.split(&quot;/&quot;).length-1] %&gt;&lt;/a&gt;</span><br><span class="line">                &lt;div class=&quot;article-digest&quot;&gt;</span><br><span class="line">                    &lt;%- post.more.replace(/&lt;\/?.+?\/?&gt;/g, &quot;&quot;).substring(0, 100) %&gt;</span><br><span class="line">                    ...</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">            &lt;/li&gt;</span><br><span class="line">            </span><br><span class="line">        &lt;% &#125;); %&gt;</span><br><span class="line">    &lt;/ul&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>美化样式</p>
<p>『css.main』</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">/* #################### 主页 #################### */</span><br><span class="line"></span><br><span class="line">#articleList &#123;</span><br><span class="line">    position: absolute;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#articleList .article-li &#123;</span><br><span class="line">    margin: 20px;</span><br><span class="line">    height: 200px;</span><br><span class="line">    border-radius: 5px;</span><br><span class="line">    box-shadow: 1px 1px 8px #999;</span><br><span class="line">    list-style: none;</span><br><span class="line">    border: 1px solid #999;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#articleList .article-digest * &#123;</span><br><span class="line">    word-wrap: break-word;</span><br><span class="line">    display: inline;</span><br><span class="line">    font-size: 12px;</span><br><span class="line">    color: #555;</span><br><span class="line">    text-decoration: none;</span><br><span class="line">    cursor:auto;</span><br><span class="line">    border-radius: none;</span><br><span class="line">    box-shadow: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#articleList .article-digest&#123;</span><br><span class="line">    padding: 30px;</span><br><span class="line">    position: relative;</span><br><span class="line">    top: 35px;</span><br><span class="line">    width: 85%;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#articleList .article-date&#123;</span><br><span class="line">    position: relative;</span><br><span class="line">    background: #e06c75;</span><br><span class="line">    color: #f9f7ed;</span><br><span class="line">    padding: 10px;</span><br><span class="line">    top: -5px;</span><br><span class="line">    border-radius: 2px;</span><br><span class="line">    margin-left: 30px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#articleList .article-read &#123;</span><br><span class="line">    position: absolute;</span><br><span class="line">    background: #e06c75;</span><br><span class="line">    color: #f9f7ed;</span><br><span class="line">    padding: 10px;</span><br><span class="line">    border-radius: 2px;</span><br><span class="line">    right: 15px;</span><br><span class="line">    margin-top: 140px;</span><br><span class="line">    text-decoration: none;</span><br><span class="line">    z-index: 1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#articleList .article-title &#123;</span><br><span class="line">    position: relative;</span><br><span class="line">    color: #555;</span><br><span class="line">    text-decoration: none;</span><br><span class="line">    font-size: 24px;</span><br><span class="line">    font-weight: bold;</span><br><span class="line">    top: 50px;</span><br><span class="line">    right: 110px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* #################### 主页 #################### */</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>添加 pjax，在 pjaxLoad 中，增加一个主页的。</p>
<p>『main.js』</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">function pjaxLoad()&#123;</span><br><span class="line">    $(document).pjax(&#x27;#tree a&#x27;, &#x27;#content&#x27;, &#123;fragment:&#x27;#content&#x27;, timeout:8000&#125;);</span><br><span class="line">    $(document).pjax(&#x27;#menu a&#x27;, &#x27;#content&#x27;, &#123;fragment:&#x27;#content&#x27;, timeout:8000&#125;);</span><br><span class="line">    $(document).pjax(&#x27;#articleList a&#x27;, &#x27;#content&#x27;, &#123;fragment:&#x27;#content&#x27;, timeout:8000&#125;);</span><br><span class="line">    $(document).on(&#123;</span><br><span class="line">        &quot;pjax:complete&quot;: function(e) &#123;</span><br><span class="line">            $(&quot;pre code&quot;).each(function (i, block)&#123;</span><br><span class="line">                hljs.highlightBlock(block);</span><br><span class="line">            &#125;);</span><br><span class="line">            </span><br><span class="line">            // 添加 active</span><br><span class="line">            $(&quot;#tree .active&quot;).removeClass(&quot;active&quot;);</span><br><span class="line">            e.relatedTarget.parentNode.classList.add(&quot;active&quot;);</span><br><span class="line"></span><br><span class="line">            showArticleIndex();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><a href="/img/626593-20190620152424403-1735811392.png" class="gallery-item" style="box-shadow: none;"> <img src="/img/626593-20190620152424403-1735811392.png"></a></p>
<p>主页设计就这样了，其实主页可以很花哨、炫酷的。可以把自己最自豪的作品展示在这里。ejs 是支持 html 编码的，所以完全可以在 ejs 中写入自己的项目。</p>
<h3 id="关于"><a href="#关于" class="headerlink" title="关于"></a>关于</h3><p>关于就是个人相关的信息，直接引入 md 就好了。在 Hexo 存放 md 的 _post 同级目录，新建 about 目录，同时在这个目录下，新建一个 index.md，在里面随便写几句话测试好了。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">wiki ➔  tree -L 3</span><br><span class="line">├── _config.yml</span><br><span class="line">├── db.json</span><br><span class="line">├── package-lock.json</span><br><span class="line">├── package.json</span><br><span class="line">├── scaffolds</span><br><span class="line">├── source</span><br><span class="line">│   ├── _posts</span><br><span class="line">│   │   ├── Docker</span><br><span class="line">│   │   ├── Hexo</span><br><span class="line">│   │   └── test-hello-world.md</span><br><span class="line">│   ├── about</span><br><span class="line">│   │   └── index.md</span><br><span class="line">└── themes</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="动漫妹纸挂件"><a href="#动漫妹纸挂件" class="headerlink" title="动漫妹纸挂件"></a>动漫妹纸挂件</h3><p>在 layout.ejs 下，追加以下代码，就有挂件。这个挂件很消耗 cpu 性能，谨慎使用。</p>
<p>『layout.ejs』</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src=&quot;https://blog-static.cnblogs.com/files/yyhh/L2Dwidget.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">L2Dwidget.init();</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>挂件出来了之后，看 html 源码中，出现了一个新的 canvas 强制修改它的位置和边框。</p>
<p>『main.css』</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">canvas#live2dcanvas &#123;</span><br><span class="line">    border: 0 !important;</span><br><span class="line">    left: 0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><a href="/img/626593-20190620152431177-793954369.png" class="gallery-item" style="box-shadow: none;"> <img src="/img/626593-20190620152431177-793954369.png"></a></p>
<h3 id="手机端自适应"><a href="#手机端自适应" class="headerlink" title="手机端自适应"></a>手机端自适应</h3><p>在 css 中设置，当浏览器窗口小于 800px 时并且处于手机竖屏状态，隐藏侧边栏，留给手机端足够的空间进行文字浏览</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">/* #################### 自适应 #################### */</span><br><span class="line"></span><br><span class="line">@media screen and (max-width: 800px) &#123;</span><br><span class="line">	aside &#123;</span><br><span class="line">		display: none;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	#content &#123;</span><br><span class="line">		padding-left: 0;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	canvas#live2dcanvas &#123;</span><br><span class="line">		display: none;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/*竖屏*/</span><br><span class="line">@media all and (orientation : portrait) &#123;</span><br><span class="line"></span><br><span class="line">	aside &#123;</span><br><span class="line">		display: none;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	#content &#123;</span><br><span class="line">		padding-left: 0;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	canvas#live2dcanvas &#123;</span><br><span class="line">		display: none;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* #################### 自适应 #################### */</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><a href="/img/626593-20190702134235874-1718772387.png" class="gallery-item" style="box-shadow: none;"> <img src="/img/626593-20190702134235874-1718772387.png"></a></p>
<p>手机端查看一眼。</p>
<p>『竖屏』</p>
<p><a href="/img/626593-20190702140920397-377231933.png" class="gallery-item" style="box-shadow: none;"> <img src="/img/626593-20190702140920397-377231933.png"></a></p>
<p>『横屏』</p>
<p><a href="/img/626593-20190702141006243-357520206.png" class="gallery-item" style="box-shadow: none;"> <img src="/img/626593-20190702141006243-357520206.png"></a></p>
</div>
    </div>

    <div class="post-meta">
        <i>
        
            <span>2024-11-21</span>
            
                <span>该篇文章被 Stone Ocean</span>
            
            
             
                <span>归为分类:
                    
                    
                        <a href='/categories/%E6%8A%80%E6%9C%AF/'>
                            技术
                        </a>
                    
                </span>
            
        
        </i>
    </div>
    <br>
    
    
        
            
    
            <div class="post-footer-pre-next">
                
                    <span>上一篇：<a href='/2024/11/21/%E6%97%BA%E6%97%BA%E7%A2%8E%E7%A2%8E%E7%89%87/'>旺旺碎碎片</a></span>
                

                
                    <span class="post-footer-pre-next-last-span-right">下一篇：<a href="/2024/11/20/%E7%A2%8E%E7%BA%B8%E7%89%87/">碎纸片</a>
                    </span>
                
            </div>
    
        
    

    
        

     
</div>



                                      
                    
                    
                    <div class="footer">
    
        <span> 
            © 2023-2024 Ocean 

            
                

            
                
                    / <a href="/friends/"> 友链 </a>
                

            
        </span>
       
    
</div>



<!--这是指一条线往下的内容-->
<div class="footer-last">
    
            <span>那年夏天宁静的海</span>
            
    
</div>


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>

    <!--目录-->
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript" ></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js" type="text/javascript" ></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.tocify/1.9.0/javascripts/jquery.tocify.min.js" type="text/javascript" ></script>
        
<script src="/js/toc.js"></script>

    

    
<script src="/js/randomHeaderContent.js"></script>

    <!--回到顶部按钮-->
    
        
<script src="/js/returnToTop.js"></script>

    

    
        
<script src="/js/returnToLastPage.js"></script>

    





<script src="/js/lightgallery/lightgallery.umd.min.js"></script>



<script src="/js/lightgallery/plugins/lg-thumbnail.umd.min.js"></script>



<script src="/js/lightgallery/plugins/lg-fullscreen.umd.min.js"></script>


<script src="/js/lightgallery/plugins/lg-autoplay.umd.min.js"></script>


<script src="/js/lightgallery/plugins/lg-zoom.umd.min.js"></script>


<script src="/js/lightgallery/plugins/lg-rotate.umd.min.js"></script>


<script src="/js/lightgallery/plugins/lg-paper.umd.min.js"></script>




<script type="text/javascript">
     
    if (typeof lightGallery !== "undefined") {
        var options1 = {
            selector: '.gallery-item',
            plugins: [lgThumbnail, lgFullscreen, lgAutoplay, lgZoom, lgRotate, lgPager], // 启用插件
            thumbnail: false,          // 显示缩略图
            zoom: false,               // 启用缩放功
            rotate: false,             // 启用旋转功能能
            autoplay: false,        // 启用自动播放功能
            fullScreen: false,      // 启用全屏功能
            pager: false, //页码,
            zoomFromOrigin: true,   // 从原始位置缩放
            actualSize: true,       // 启用查看实际大小的功能
            enableZoomAfter: 300,    // 延迟缩放，确保图片加载完成后可缩放
        };
        lightGallery(document.getElementsByClassName('.article-gallery')[0], options1); // 修复选择器
    }
    
</script>


    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script> 

                </div>
            
            
                <!-- 回到顶部的按钮-->  
                <div class="progress-wrap shadow-drop-2-bottom">
                    <svg class="progress-circle svg-content" width="100%" height="100%" viewBox="-1 -1 102 102">
                        <path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98"/>
                    </svg>
                </div>
            
            
                <!-- 返回的按钮-->  
                <div class="return-to-last-progress-wrap shadow-drop-2-bottom">
                    <svg class="progress-circle svg-content" width="100%" height="100%" viewBox="-1 -1 102 102">
                        <path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98"/>
                    </svg>
                </div>
            
    </body>
</html>